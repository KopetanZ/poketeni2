# ポケモン個体値×テニススキル統合システム仕様書

## 概要
ポケモンの個体値システムとテニススキルを完全連動させた戦略的育成システム

## システム設計思想

### 基本コンセプト
- **ポケモンらしい個体差**: 同じ種族でも個体によって能力が大きく異なる
- **テニス戦略性**: 攻撃的・守備的・技巧的など多様な戦術が可能
- **長期育成**: 厳選・育成・試合の完全なゲームループ
- **成長実感**: 数値による明確な進歩の可視化

## 能力対応関係

### テニススキル ← ポケモン種族値の対応
```typescript
サーブ力     ← 攻撃力      (パワーショットの威力)
リターン力   ← 防御力      (相手攻撃を受け止める力)  
ボレー力     ← 特攻        (技巧的な攻撃力)
ストローク力 ← 特防        (持久戦での粘り強さ)
メンタル力   ← HP          (精神的なタフネス)
スタミナ     ← 素早さ      (機動力・持久力)
```

## 個体値システム

### 基本仕様
- **範囲**: 0-31 (ポケモン原作準拠)
- **対象**: HP・攻撃・防御・特攻・特防・素早さ (6種類)
- **生成確率**: 完全ランダム (理想個体1/32^6 ≒ 1/10億)
- **可視化**: 段階的開示システム

### 個体値ランク判定
```typescript
合計個体値による評価:
- Sランク (180-186): "素晴らしい能力を持っている！"
- Aランク (151-179): "かなり優秀な能力だ"
- Bランク (121-150): "平均以上の能力を持っている"
- Cランク (91-120):  "普通の能力といったところ"
- Dランク (0-90):    "まずまずの能力かな"
```

### 段階的個体値開示
```typescript
初期状態: 全個体値「??」で隠蔽
解放条件:
- レベル20到達 → 一部個体値が判明
- 試合10回以上 → 追加個体値が判明  
- 個体値ジャッジャー → 全個体値解放
- デバッグモード → 即座に全解放
```

## 性格システム

### 25種類の性格実装
```typescript
// 攻撃系 (サーブ力重視)
'いじっぱり': 攻撃↑(1.1倍), 特攻↓(0.9倍)
'やんちゃ':   攻撃↑(1.1倍), 特防↓(0.9倍)
'ゆうかん':   攻撃↑(1.1倍), 素早↓(0.9倍)
'さみしがり': 攻撃↑(1.1倍), 防御↓(0.9倍)

// 防御系 (リターン力重視)  
'ずぶとい':   防御↑(1.1倍), 攻撃↓(0.9倍)
'わんぱく':   防御↑(1.1倍), 特攻↓(0.9倍)
'のうてんき': 防御↑(1.1倍), 特防↓(0.9倍)
'のんき':     防御↑(1.1倍), 素早↓(0.9倍)

// 特攻系 (ボレー力重視)
'ひかえめ':   特攻↑(1.1倍), 攻撃↓(0.9倍)
'おっとり':   特攻↑(1.1倍), 防御↓(0.9倍)
'うっかりや': 特攻↑(1.1倍), 特防↓(0.9倍)
'れいせい':   特攻↑(1.1倍), 素早↓(0.9倍)

// 特防系 (ストローク力重視)
'おだやか':   特防↑(1.1倍), 攻撃↓(0.9倍)
'おとなしい': 特防↑(1.1倍), 防御↓(0.9倍)
'しんちょう': 特防↑(1.1倍), 特攻↓(0.9倍)
'なまいき':   特防↑(1.1倍), 素早↓(0.9倍)

// 素早さ系 (スタミナ重視)
'ようき':     素早↑(1.1倍), 特攻↓(0.9倍)
'むじゃき':   素早↑(1.1倍), 特防↓(0.9倍)
'せっかち':   素早↑(1.1倍), 防御↓(0.9倍)
'おくびょう': 素早↑(1.1倍), 攻撃↓(0.9倍)

// 補正なし (バランス型)
'がんばりや', 'すなお', 'てれや', 'きまぐれ', 'まじめ'
```

## 努力値システム

### 基本仕様
```typescript
取得上限: 各能力255まで、合計510まで
取得方法:
- 練習カード使用: カード種類により特定努力値+1〜5
- 試合勝利: 相手に応じて各種努力値+1〜3
- 特訓アイテム: 大量努力値獲得アイテム
```

### 配分プリセット
```typescript
'balanced':    全能力均等配分
'offensive':   攻撃・特攻重点 (サーブ・ボレー型)
'defensive':   防御・特防重点 (守備型)
'speedy':      素早さ重点 (スタミナ型)
'tank':        HP・防御重点 (メンタル・リターン型)
'technical':   特攻・素早さ重点 (ボレー・スタミナ型)
'physical':    攻撃・素早さ重点 (サーブ・スタミナ型)
'custom':      プレイヤー自由配分
```

## 能力値計算システム

### 計算式 (ポケモン原作準拠)
```typescript
// HP以外の能力値
((種族値 × 2 + 個体値 + 努力値÷4) × レベル ÷ 50 + 10) × 性格補正

// HP (メンタル力)
((種族値 × 2 + 個体値 + 努力値÷4) × レベル ÷ 50 + レベル + 15)

性格補正:
- 上昇能力: × 1.1
- 下降能力: × 0.9  
- その他: × 1.0
```

### レベル1とレベル50での能力差例
```typescript
フシギダネ (攻撃種族値49) の場合:

個体値0、努力値0:
- Lv1: 攻撃10 → サーブ力10
- Lv50: 攻撃58 → サーブ力58

個体値31、努力値252:
- Lv1: 攻撃11 → サーブ力11  
- Lv50: 攻撃111 → サーブ力111

性格「いじっぱり」(攻撃↑):
- Lv50: 攻撃122 → サーブ力122

最終差: 122 - 58 = 64 (約2倍の差！)
```

## 特殊要素

### 色違いシステム
```typescript
出現確率: 1/4096 (ポケモン原作準拠)
特典: 
- 全能力値+5ボーナス
- 特別な見た目エフェクト ✨
- レアリティコレクション価値
- 試合時の特別演出
```

### 6V個体 (理想個体)
```typescript
条件: 全個体値31 (HP・攻撃・防御・特攻・特防・素早さ)
確率: 1/1,073,741,824 (約10億分の1)
特典:
- "完璧な個体" の称号
- 全能力最大ポテンシャル
- 超レア収集価値
```

## UI・UX設計

### ポケモン詳細画面
```typescript
タブ構成:
1. 📊 能力値タブ
   - 最終テニス能力値 (バー表示)
   - 努力値配分 (510/510)
   - 装備ボーナス表示

2. 📈 成長タブ  
   - レベルアップ経験値バー
   - 🆙 レベルアップボタン
   - 🌟 進化ボタン (条件達成時)

3. 🔍 個体値ジャッジタブ
   - 個体値表示 (段階的開示)
   - ジャッジコメント
   - 🔓 解放ボタン (デバッグ用)
```

### 選手一覧統合
```typescript
各選手カードに追加:
- 📊 詳細表示ボタン → ポケモン詳細画面
- ⚡ 装備ボタン → 装備管理画面
- ランク表示 (S/A/B/C/D)
- 色違いマーク ✨
```

## データベース統合

### 型定義統合
```typescript
// types/game.ts に追加
export interface Player {
  // 既存フィールド...
  pokemon_stats?: PokemonStats; // 新個体値システム
}
```

### データ移行戦略
```typescript
1. 後方互換性維持
   - pokemon_stats が null の場合は旧システム使用
   - 段階的移行により既存データ保護

2. 新規選手生成
   - PokemonStatsCalculator.generateNewPokemon() 使用
   - 自動的に個体値・性格・努力値を設定

3. 既存選手アップグレード  
   - 選手詳細画面で自動変換
   - プレイヤー同意のもと個体値付与
```

## 戦略性の向上

### 厳選要素
```typescript
理想の組み合わせ例:

サーブ特化型:
- 性格: いじっぱり (攻撃↑)  
- 努力値: 攻撃252, 素早さ252
- 個体値: 攻撃31, 素早さ31重視
- 装備: パワーラケット

守備特化型:  
- 性格: ずぶとい (防御↑)
- 努力値: HP252, 防御252
- 個体値: HP31, 防御31重視
- 装備: 耐久装備

バランス型:
- 性格: がんばりや (補正なし)
- 努力値: 全体均等配分
- 個体値: 全体的に高水準
- 装備: 万能装備
```

### 対戦メタゲーム
```typescript
相性システム:
- 高攻撃 vs 高防御 の読み合い
- スピード重視 vs パワー重視
- 技巧派 vs パワー派
- バランス型 vs 特化型

チーム編成:
- 得意分野の異なる3人体制
- 相手に応じた戦術変更
- 個体値を活かした役割分担
```

## 実装完了機能

### ✅ 完成済み
1. **個体値システム** - 0-31の6種類個体値
2. **性格システム** - 25種類の性格による能力補正
3. **努力値システム** - 練習・試合による成長
4. **能力値計算** - ポケモン原作準拠の計算式
5. **UI統合** - 詳細表示画面とメイン画面統合
6. **レベルアップ** - 経験値による成長システム
7. **個体値ジャッジ** - 段階的開示とランク判定
8. **色違いシステム** - 1/4096確率の特別個体

### 🚧 実装予定 (優先度順)
1. **進化システム** - レベル条件での種族進化
2. **特性システム** - ポケモン固有の特別能力
3. **努力値配分UI** - プレイヤーによる自由配分
4. **個体値厳選機能** - 理想個体の効率的獲得
5. **成長履歴** - 育成過程の記録・可視化

---

## 技術実装詳細

### 主要ファイル
```typescript
/src/types/pokemon-stats.ts          - 型定義
/src/lib/pokemon-species-data.ts     - 種族値データ
/src/lib/pokemon-stats-calculator.ts - 計算ロジック
/src/components/pokemon/PokemonStatsViewer.tsx - UI
/src/lib/player-generator.ts         - 統合済み生成システム
```

### データフロー
```typescript
ポケモン生成 → 個体値決定 → 性格決定 → 初期能力計算 
     ↓
練習・試合 → 経験値・努力値獲得 → レベルアップ → 能力再計算
     ↓  
装備変更 → ボーナス適用 → 最終能力値 → 試合パフォーマンス
```

この個体値システムにより、**ポケモンらしい奥深い育成要素**と**テニスゲームとしての戦略性**が完全に融合され、長期的なやり込み要素が大幅に向上しました。

*記録日: 2025年8月6日*  
*バージョン: 個体値システム v1.0*